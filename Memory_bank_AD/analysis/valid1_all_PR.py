import matplotlib.pyplot as plt
import numpy as np

# ===========================
# ASCISSE COMUNI (% GOOD)
# ===========================

good_fractions = np.array([
    0.05, 0.10, 0.15, 0.20, 0.25,
    0.30, 0.35, 0.40, 0.45, 0.50,
    0.55, 0.60, 0.65, 0.70, 0.75,
    0.80, 0.85, 0.90, 0.95, 1.00
])

# ===========================
# TUTTI I PR (Pixel AUPRC) PER PEZZO E METODO
# ===========================
# Metodi: SPADE, PaDiM, InReaCh, FAPM

results_pr = {

    "PZ1": {
        "SPADE": [
            0.37628477313527753, 0.3852055454593263, 0.3853545523194072,
            0.3868135213187536, 0.38386700648722105, 0.38245887423353697,
            0.38410476101972113, 0.38455286625916985, 0.38145339209006235,
            0.3798342916790881, 0.38009749968246653, 0.3809921963942688,
            0.38084523969256384, 0.3824127435944609, 0.38354238163579607,
            0.38354255892662903, 0.3830179406012082, 0.382788936426361,
            0.3827369522466937, 0.38273705759049115
        ],
        "PaDiM": [
            0.28320866690517016, 0.28204555090543193, 0.28201465113624835,
            0.2949366788122274, 0.29541748723801137, 0.29481587535798986,
            0.29345189821546, 0.2964347020130453, 0.2960887130549317,
            0.2970422811386387, 0.29687483809845544, 0.2969942447691679,
            0.2963696347923221, 0.2968232969656357, 0.2970259894788179,
            0.2969802339033014, 0.29678260753293056, 0.29642384092349416,
            0.2964026057253014, 0.29648373729526095
        ],
        "InReaCh": [
            0.2328, 0.2443, 0.2421, 0.2417, 0.2413,
            0.2428, 0.2423, 0.2435, 0.2416, 0.2419,
            0.2412, 0.2435, 0.2429, 0.2405, 0.2412,
            0.2432, 0.2423, 0.2396, 0.2403, 0.2412,
        ],
        "FAPM": [
            0.24595659476146536, 0.2511776092454834, 0.25314752322572653,
            0.2517879198747878, 0.25349528653474107, 0.25372443022531466,
            0.2514902049692362, 0.2508088315704273, 0.2513884940901535,
            0.25210651491135616, 0.251503400491267, 0.25104544457204736,
            0.25101799629490956, 0.2509309881035764, 0.2511721767361612,
            0.25180123385326286, 0.2509805241022012, 0.2515794838588196,
            0.25209392735130653, 0.25222066844562263
        ],
    },

    "PZ2": {
        "SPADE": [
            0.3856878190204944, 0.3754095351229021, 0.3758384796670054,
            0.37456337192821726, 0.37379332085546974, 0.37341775771979047,
            0.3740601844500864, 0.37399601433003743, 0.37568527730210116,
            0.37733351785533875, 0.37830940978395855, 0.37793051824544716,
            0.37750235480600997, 0.37750418689669607, 0.38136986591298,
            0.3803182120041766, 0.3798027589454287, 0.3798016720894075,
            0.3829180062648343, 0.37932511759833815
        ],
        "PaDiM": [
            0.3324311821034204, 0.3306627054525935, 0.3302498018256176,
            0.3307560802169433, 0.3310620994917191, 0.33098223401177446,
            0.33117270213095296, 0.3312069675436914, 0.3309273225351591,
            0.3311119881567339, 0.3308842319351213, 0.33091945092394287,
            0.33087188059704015, 0.3309041034666387, 0.3311802779642701,
            0.3310526627022158, 0.33098657821668187, 0.33094181098765685,
            0.33096807705240894, 0.33087460656034073
        ],
        "InReaCh": [
            0.20998825449881753, 0.21149741134556035, 0.21147418773181836,
            0.21207393607789876, 0.20933143768488635, 0.21126148686166718,
            0.2094384836150257, 0.21115874523289463, 0.21156662085456684,
            0.21321357563489088, 0.20980135406728795, 0.20953726574097717,
            0.21014143070032476, 0.21108867117819813, 0.2094881054866318,
            0.21014505697410235, 0.2114263881990595, 0.20981649692792181,
            0.21104808727631247, 0.2116349520933388
        ],
        "FAPM": [
            0.19549628742934227, 0.19239006033984363, 0.19968424417205238,
            0.1900793844696434, 0.19486469857199637, 0.19160892611127944,
            0.19194243774371467, 0.19385479083518303, 0.19364389457117803,
            0.19454591920516934, 0.19380870480065204, 0.1938965695262358,
            0.19458147974521672, 0.1941956215957374, 0.19504485788270765,
            0.1961797699785383, 0.19524815720736505, 0.1952905785682841,
            0.19422072472385044, 0.19397064468299394
        ],
    },

    "PZ3": {
        "SPADE": [
            0.38487332107269334, 0.382444554990845, 0.38506570687029246,
            0.38583669401292353, 0.386378142893139, 0.39588307541538414,
            0.39485480788181615, 0.3955197647930717, 0.3964330041466208,
            0.3884068805697951, 0.390660177953064, 0.39210575831921035,
            0.3934205544964676, 0.3927946145546325, 0.39325337047050785,
            0.3913675591270267, 0.39174977987015414, 0.390708564958743,
            0.38890593742188234, 0.3869419769252004
        ],
        "PaDiM": [
            0.3460907450119339, 0.3467584873294068, 0.3355639579718383,
            0.32867724422479916, 0.32809658752798915, 0.3252066432122274,
            0.32573996807398675, 0.32646167029896267, 0.3267833762666736,
            0.3269197413753036, 0.3272269212641779, 0.3265885002389075,
            0.3260539282389744, 0.32635487548785835, 0.32632266798227305,
            0.3262322840101411, 0.3264825672968593, 0.3266964063648802,
            0.3264970153913, 0.32678556561339944
        ],
        "InReaCh": [
            0.25751324646139556, 0.2634259057132716, 0.282270761850144,
            0.2812302655199745, 0.27873125667512694, 0.27806778160933276,
            0.2754217043616516, 0.27567769931549757, 0.27414461082745845,
            0.275728376056199, 0.2755846733727614, 0.27653106641474257,
            0.27520333993725, 0.2732465085023467, 0.2732341908478533,
            0.27229452909408264, 0.270887143268118, 0.27369292437685055,
            0.27247188775900877, 0.2711432999653236
        ],
        "FAPM": [
            0.2551959397077054, 0.25049858707283784, 0.25298834276489723,
            0.251506004966367, 0.2527898491056184, 0.2554617447167211,
            0.25131416500303266, 0.25167437275714305, 0.25288864155394286,
            0.24988423151554787, 0.2504226272595715, 0.251656737158216,
            0.25090484690395853, 0.2517325603391506, 0.251840556004588,
            0.2490799313808752, 0.25368990057838375, 0.25227340921339203,
            0.2532760045585839, 0.25428314029915877
        ],
    },

    "PZ4": {
        "SPADE": [
            0.18102345106087103, 0.21953012869050353, 0.2192760653149158,
            0.22309112957552235, 0.2179089572069204, 0.21667124795250656,
            0.21732004107851613, 0.2179428112674226, 0.21713695646789938,
            0.2157463506721987, 0.22053457313310393, 0.21564993292845383,
            0.21554798919475388, 0.21657675599647136, 0.21730378973140785,
            0.21848870353116487, 0.2180047376738357, 0.21750491342218145,
            0.21690238837970244, 0.21738845927173878
        ],
        "PaDiM": [
            0.0962663227542501, 0.16062209044387565, 0.1799546687668102,
            0.17882802106226614, 0.17157198316189182, 0.16542795077757091,
            0.16570974976512853, 0.16490464600238647, 0.1680384588915107,
            0.17442827587520482, 0.17384391058193585, 0.17260468877857704,
            0.17079947053766412, 0.16879501050121004, 0.16783792484748683,
            0.1699303226132186, 0.1671104024200717, 0.1653451765084546,
            0.16739906710235908, 0.1662356878132434
        ],
        "InReaCh": [
            0.18102345106087103, 0.21953012869050353, 0.2192760653149158, 0.22309112957552235,
            0.2179089572069204, 0.21667124795250656, 0.21732004107851613, 0.2179428112674226,
            0.21713695646789938, 0.2157463506721987, 0.22053457313310393, 0.21564993292845383,
            0.21554798919475388, 0.21657675599647136, 0.21730378973140785, 0.21848870353116487,
            0.2180047376738357, 0.21750491342218145, 0.21690238837970244, 0.21738845927173878
        ],
        "FAPM": [
            0.10661431633135993, 0.1568526946324217, 0.16635862276632862,
            0.19542316130679638, 0.17258991160162662, 0.15162327303661483,
            0.15466450307910992, 0.15310970926188633, 0.15639813672385788,
            0.15459961263939087, 0.15832483830246327, 0.15508373372547377,
            0.15703571815783565, 0.16138385818308248, 0.1563591579251631,
            0.15729257204029196, 0.16062342576150504, 0.15569089023011917,
            0.15735003530199168, 0.1576929508931863
        ],
    },

    "PZ5": {
        "SPADE": [
            0.19188720431055095, 0.18987927049488765, 0.18454805134938806,
            0.1821921776797606, 0.18111868450184457, 0.17899636876735303,
            0.18460696554600306, 0.18342385642272369, 0.18380051310085188,
            0.17946137897350464, 0.17947540099779946, 0.18146989541898761,
            0.1784107478129718, 0.1787911695159459, 0.17946847884609166,
            0.1770007932284528, 0.17970486359992255, 0.17978292473569396,
            0.1689424584990004, 0.1665451061937673
        ],
        "PaDiM": [
            0.1271860778522705, 0.13794428464356423, 0.12511563187592595,
            0.1237275465594552, 0.12799937539820608, 0.12778740925910254,
            0.1269595965048737, 0.1267614322837219, 0.1264693410723022,
            0.12686378008981575, 0.12742322560403227, 0.1270886445063868,
            0.126991381409064, 0.12764335228329043, 0.12801642310240743,
            0.12816299843776732, 0.12831940663799002, 0.12820153941279908,
            0.12833425345463476, 0.12787406739119944
        ],
        "InReaCh": [
            0.06982684753177973, 0.10338972361622431, 0.10328788138646548,
            0.104541480351691, 0.10489985667814795, 0.10574167035844438,
            0.10510898286921244, 0.10494419544103502, 0.10491201486894242,
            0.10480395256574347, 0.10486221345622608, 0.10486181586036908,
            0.10476485123051316, 0.10417735807314837, 0.10471736623578581,
            0.10535319554941386, 0.10524660731552121, 0.10443334445951749,
            0.10551094139544297, 0.10476291464320046
        ],
        "FAPM": [
            0.030012308723632763, 0.0746378333236338, 0.07566585011271587,
            0.08801815553174926, 0.08556388638604483, 0.08496754264746201,
            0.08895470629298939, 0.08719735759704648, 0.08688924325984985,
            0.0888216019563163, 0.08778660013053173, 0.08653816487552735,
            0.08656412543889959, 0.08875157049995382, 0.08857051887234078,
            0.08722235840118378, 0.08869884409836995, 0.08968712991548218,
            0.08822970627634946, 0.08892662821523026
        ],
    },
}

# Colori per i metodi
colors = {
    "SPADE": "red",
    "PaDiM": "blue",
    "InReaCh": "green",
    "FAPM": "purple",
}

# =================================================
# FUNZIONE PER PLOTTARE TUTTI I METODI SU UN PEZZO (PR)
# =================================================

def plot_piece_pr(piece_name, methods_dict):
    print(f"Plotting PR for {piece_name} ...")

    plt.figure(figsize=(8, 5))

    for method_name, values in methods_dict.items():
        plt.plot(
            good_fractions,
            values,
            marker="o",
            label=method_name,
            color=colors.get(method_name, None)  # usa colore se definito
        )

    plt.title(f"{piece_name} â€“ Pixel-level AUPRC vs Good Fraction")
    plt.xlabel("Good Fraction")   # Asse X = %
    plt.ylabel("Pixel AUPRC")     # Asse Y = PR
    plt.grid(True)
    plt.legend()
    plt.tight_layout()
    plt.show()


# =================================================
# ESEGUI LA PLOTTATURA PER TUTTI I PEZZI
# =================================================

for piece, methods_dict in results_pr.items():
    plot_piece_pr(piece, methods_dict)
