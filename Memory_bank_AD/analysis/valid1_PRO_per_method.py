import matplotlib.pyplot as plt
import numpy as np

# ===========================
# ASCISSE COMUNI (% GOOD)
# ===========================

good_fractions = np.array([
    0.05, 0.10, 0.15, 0.20, 0.25,
    0.30, 0.35, 0.40, 0.45, 0.50,
    0.55, 0.60, 0.65, 0.70, 0.75,
    0.80, 0.85, 0.90, 0.95, 1.00
])

# ===========================
# TUTTI I PRO (Pixel AUC-PRO)
# PER METODO E PEZZO
# ===========================

results_pro_by_method = {

    "SPADE": {
        "PZ1": [
            0.11087252197424977, 0.11340548111337394, 0.11331733593755804,
            0.11203542493915582, 0.11256802579809218, 0.11360873362921073,
            0.11365698603478008, 0.1142461796657192, 0.11128458577213331,
            0.11339030972747555, 0.11283217478628635, 0.11373409320384516,
            0.11719657656137168, 0.1179152265693238, 0.11824045900503673,
            0.11824046239662969, 0.11729034612581454, 0.11741818571534113,
            0.11728852307120295, 0.11720684605642769
        ],
        "PZ2": [
            0.425391068502503, 0.41889448542142554, 0.41774674090077407,
            0.4174590835855749, 0.42278052217214507, 0.41936511254737,
            0.417880352469389, 0.41874162961373407, 0.41700982081003224,
            0.4191804961253322, 0.41758562161773705, 0.4188010317876578,
            0.41806313296849423, 0.41855176615889794, 0.4216250865934617,
            0.42123867932258374, 0.4215912426157646, 0.4215890979983781,
            0.4240395570338973, 0.4196159174284243
        ],
        "PZ3": [
            0.3462070484772058, 0.34750291537696876, 0.3486170653876265,
            0.3460922846027137, 0.35235229704195453, 0.3449398262412489,
            0.3443667901883821, 0.34643670855443165, 0.35166779959315475,
            0.3489885749997678, 0.34843652353569626, 0.3423183186422362,
            0.3390298017458589, 0.3383755539099694, 0.33970328175425524,
            0.33887848186464653, 0.3393647384747982, 0.34358282057114153,
            0.3424948752548963, 0.34289089491441943
        ],
        "PZ4": [
            0.28457370813467237, 0.3808376578900595, 0.3802124249622595,
            0.3878235687340558, 0.389596958901286, 0.3887411959473446,
            0.39741161530825003, 0.39508906704221775, 0.39415663866573236,
            0.39322936276570486, 0.3891010134503179, 0.39177786452662683,
            0.3923019630427047, 0.3906383328282678, 0.3938142182784793,
            0.39496134318800563, 0.3931495702875401, 0.39380319902562333,
            0.39360559372661125, 0.3941083367977591
        ],
        "PZ5": [
            0.43701092845919, 0.43947871371250063, 0.4345595159948547,
            0.4283886617148281, 0.4261605974071543, 0.42130577412246095,
            0.4270694787081995, 0.42456758324159805, 0.4261548948562148,
            0.41905606435880677, 0.4162238810542892, 0.42807419690974796,
            0.42417037536502694, 0.4247596633356275, 0.4252285183577841,
            0.4091195915748805, 0.4260223820903671, 0.4280293175523842,
            0.4009469702714947, 0.3967902733869354
        ],
    },

    "PaDiM": {
        "PZ1": [
            0.08744497888296383, 0.08767156697145892, 0.08767378538154276,
            0.08504840061249498, 0.08509348529991394, 0.08536381536786687,
            0.08524817773847868, 0.08543932182728185, 0.08539661913837149,
            0.08560711860973409, 0.08565006711058308, 0.08568433128447131,
            0.08534191072588375, 0.08548267761339703, 0.08556154841348547,
            0.08568416221297286, 0.0857596078197295, 0.08575342951289672,
            0.08561540711009409, 0.08564063643070258
        ],
        "PZ2": [
            0.3381531737758394, 0.3383806149068506, 0.3395311577156407,
            0.3390790337030213, 0.33905468290704877, 0.33860946402045483,
            0.33858430708156834, 0.33848084828378744, 0.3382299207787366,
            0.3385368618887084, 0.3378960869118572, 0.337836619422268,
            0.3379925346948163, 0.3381080595917014, 0.3383565680806003,
            0.338142223664965, 0.338128895315691, 0.33812236125243555,
            0.33805983272494095, 0.3379379028230224
        ],
        "PZ3": [
            0.2991728937222984, 0.3003193237188753, 0.29892462749473403,
            0.30170924130788995, 0.3016659397388433, 0.30053106559534276,
            0.30034095217869167, 0.2996927448993001, 0.29974938376392024,
            0.29953188667002584, 0.2995092620562136, 0.2982086871367637,
            0.29762551024944456, 0.2977598207575747, 0.29767840591831235,
            0.29757732681172827, 0.2976450953692609, 0.2979290578812319,
            0.2975699020641898, 0.2975666159751821
        ],
        "PZ4": [
            0.16058780756730998, 0.26198779391387406, 0.3061562322391671,
            0.3092061682490086, 0.29979661354859277, 0.29382944055474236,
            0.29298504636761585, 0.29318321330758473, 0.29023350592071784,
            0.3079007386603064, 0.30880658018745594, 0.307005917354412,
            0.30365254417409354, 0.3025939050488878, 0.3022824013787162,
            0.3133728883894759, 0.3120217258298077, 0.31037540477038517,
            0.31333131759446203, 0.3119949374138693
        ],
        "PZ5": [
            0.3063580563160755, 0.3262344498862727, 0.3185416707844743,
            0.3166295663836612, 0.32362107265917894, 0.3225020837531523,
            0.3210229494151625, 0.3205172144687826, 0.3199793259697933,
            0.3204991595800982, 0.3213556261698306, 0.3206673953620999,
            0.32052417004632006, 0.3212083010119231, 0.32159699945169246,
            0.32176360939843635, 0.32180551530195395, 0.3221013894723502,
            0.32219802744073056, 0.32165753252378476
        ],
    },

    "InReaCh": {
        "PZ1": [
            0.0606, 0.0617, 0.0615, 0.0605, 0.0604,
            0.0609, 0.0602, 0.0606, 0.0604, 0.0601,
            0.0599, 0.0605, 0.0604, 0.0598, 0.0602,
            0.0607, 0.0606, 0.0597, 0.0599, 0.0598,
        ],
        "PZ2": [
            0.2742691863488489, 0.2617731155736744, 0.2743792910125883,
            0.27382847344798394, 0.27287243305201797, 0.272271744496494,
            0.2745098085510884, 0.2738459578368053, 0.2696112816924256,
            0.27166145373137673, 0.2725422465442567, 0.27306924352503675,
            0.2728769845487228, 0.27329775060762884, 0.2730469730839246,
            0.2722022663093154, 0.2710362320641046, 0.2738560097928563,
            0.27179803599771457, 0.2719774775172088
        ],
        "PZ3": [
            0.17121043618862064, 0.1948724647271572, 0.19610023425250983,
            0.19616891569155193, 0.19414249152545332, 0.1939756470874524,
            0.1908715982045907, 0.1929101927513219, 0.1960085582174391,
            0.19068183810265316, 0.18928985585620828, 0.19079064859600514,
            0.19004751970942535, 0.19174948059758973, 0.19168906076695164,
            0.19191521318560467, 0.1915197215562739, 0.1887817162446846,
            0.19068568815526954, 0.19153331910550503
        ],
        "PZ4": [
            0.28457370813467237, 0.3808376578900595, 0.3802124249622595, 0.3878235687340558, 
            0.389596958901286, 0.3887411959473446, 0.39741161530825003, 0.39508906704221775,
            0.39415663866573236, 0.39322936276570486, 0.3891010134503179, 0.39177786452662683,
            0.3923019630427047, 0.3906383328282678, 0.3938142182784793, 0.39496134318800563,
            0.3931495702875401, 0.39380319902562333, 0.39360559372661125, 0.3941083367977591
        ],
        "PZ5": [
            0.21336586443092656, 0.26910247084833516, 0.265818190243677, 0.26803470791831585,
            0.2675769280861794, 0.26835536322988474, 0.26695917302770966, 0.2663493374104287,
            0.26559105926040927, 0.2676628536511437, 0.2658780759085888, 0.2662354850553026,
            0.26603045815112647, 0.2650672520009128, 0.2650526379630122, 0.26656540980605165,
            0.2663570379195067, 0.26502153097773357, 0.2660633697348313, 0.2641916584619647
        ],
    },

    "FAPM": {
        "PZ1": [
            0.06654135967098812, 0.06496616075860331, 0.06576464748893572,
            0.06449156137655737, 0.06473073915608359, 0.06494060836508138,
            0.06367169054877397, 0.06372694053420806, 0.06383246754455059,
            0.06392176944830591, 0.06380236709750173, 0.06348797209205466,
            0.06375660044276998, 0.06358308001409427, 0.06373654625063427,
            0.06408354453714254, 0.0638509381589041, 0.06398448426291126,
            0.06399576196208387, 0.06422357888153213
        ],
        "PZ2": [
            0.2461345744244099, 0.24667592769198743, 0.2530989891572038,
            0.24341125119281365, 0.2482077617135245, 0.24624371866735675,
            0.2450232101446227, 0.24430577685056992, 0.2440215580471748,
            0.24541022453531625, 0.2455312939515317, 0.24694092213442545,
            0.2457531060770421, 0.24409189015946595, 0.24543113877490536,
            0.24509413728179535, 0.2465492809780675, 0.2458184872706499,
            0.2459155082465228, 0.24475913883077274
        ],
        "PZ3": [
            0.23905632287409528, 0.22549453831436092, 0.24085316225367104,
            0.21016411295230655, 0.2120111689543461, 0.2161156345303901,
            0.20349812906450818, 0.2062987009507453, 0.2056531540569935,
            0.2025537125606674, 0.205290524042962, 0.20510225632855944,
            0.20639125929406624, 0.20478547196952926, 0.20664474986617706,
            0.2082099033155294, 0.21370758960531328, 0.2113625613217648,
            0.2141729689006719, 0.21054475225086194
        ],
        "PZ4": [
            0.11423061722244253, 0.1989151220773653, 0.25465726541209116,
            0.32397574303819654, 0.30951949219835256, 0.2697735607328019,
            0.2580724572917247, 0.262687567358881, 0.26806428920589803,
            0.2576870882935318, 0.27509408010290104, 0.2554847455796351,
            0.26390296108602335, 0.2739194281491655, 0.2668905485244346,
            0.2644559249458161, 0.2650445727690106, 0.2654710946646847,
            0.2742223070542129, 0.2633319522794662
        ],
        "PZ5": [
            0.10777092658015804, 0.24690530947100583, 0.2232114967847964,
            0.2536826079749421, 0.2448716350979185, 0.2415575841094984,
            0.24771124987491427, 0.2483563469700513, 0.24440062759241418,
            0.24874967470721404, 0.24469896613200334, 0.2451539403949736,
            0.24479397645201115, 0.24960687262609751, 0.24837951056157662,
            0.24619304680495085, 0.24855506943701655, 0.2513555705332111,
            0.24841882901834983, 0.24953456264650534
        ],
    },
}

# Colori per i pezzi
colors_pieces = {
    "PZ1": "blue",
    "PZ2": "orange",
    "PZ3": "green",
    "PZ4": "red",
    "PZ5": "purple",
}

# =================================================
# FUNZIONE PER PLOTTARE TUTTI I PEZZI SU UN METODO (PRO)
# =================================================

def plot_method_pro(method_name, pieces_dict):
    print(f"Plotting PRO for method {method_name} ...")

    plt.figure(figsize=(8, 5))

    for piece_name, values in pieces_dict.items():
        plt.plot(
            good_fractions,
            values,
            marker="o",
            label=piece_name,
            color=colors_pieces.get(piece_name, None)
        )

    plt.title(f"{method_name} â€“ Pixel-level AUC-PRO vs Good Fraction")
    plt.xlabel("Good Fraction")   # Asse X = %
    plt.ylabel("Pixel AUC-PRO")   # Asse Y = PRO
    plt.grid(True)
    plt.legend()
    plt.tight_layout()
    plt.show()


# =================================================
# ESEGUI LA PLOTTATURA PER TUTTI I METODI
# =================================================

for method, pieces_dict in results_pro_by_method.items():
    plot_method_pro(method, pieces_dict)
