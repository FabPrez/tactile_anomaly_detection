import matplotlib.pyplot as plt
import numpy as np

# ===========================
# ASCISSE COMUNI (% GOOD)
# ===========================

good_fractions = np.array([
    0.05, 0.10, 0.15, 0.20, 0.25,
    0.30, 0.35, 0.40, 0.45, 0.50,
    0.55, 0.60, 0.65, 0.70, 0.75,
    0.80, 0.85, 0.90, 0.95, 1.00
])

# ===========================
# PRO (Pixel AUC-PRO) PER SEED
# SPADE – PZ1..PZ5
# Ogni pezzo: lista di liste [seed0 ... seed9]
# ===========================

results_pro_by_method = {

    "SPADE": {

        "PZ1": [
            # ----- SEED 0 -----
            [
                0.11087252197424977, 0.11340548111337394, 0.11331733593755804,
                0.11203542493915582, 0.11256802579809218, 0.11360873362921073,
                0.11365698603478008, 0.1142461796657192,  0.11128458577213331,
                0.11339030972747555, 0.11283217478628635, 0.11373409320384516,
                0.11719657656137168, 0.1179152265693238,  0.11824045900503673,
                0.11824046239662969, 0.11729034612581454, 0.11741818571534113,
                0.11728852307120295, 0.11720684605642769
            ],
            # ----- SEED 1 -----
            [
                0.11319407213303909, 0.11210365376504014, 0.10965624864517427,
                0.1110958168039824,  0.11236275804478509, 0.1141065780794545,
                0.1134092139211146,  0.11355514633101395, 0.1135945522703035,
                0.11582797972611493, 0.11864769571940659, 0.11864824536111794,
                0.11864828503045508, 0.11874327311860064, 0.11904595690243602,
                0.1180146206322242,  0.1165938550446574,  0.11700711538951976,
                0.11691350049128736, 0.11720678599058623
            ],
            # ----- SEED 2 -----
            [
                0.10985599506487544, 0.11001121756781183, 0.11143509687724427,
                0.1117257312391625,  0.11702252964996786, 0.11345413357114988,
                0.11321944223476102, 0.11277979790390183, 0.11320448979668563,
                0.1146210222989147,  0.11951400006122602, 0.11951555019200853,
                0.11966349302666242, 0.11962555085912069, 0.11962838075520428,
                0.11941498144558983, 0.11941498239323758, 0.118628365037087,
                0.11720600132904377, 0.11720667475976063
            ],
            # ----- SEED 3 -----
            [
                0.11770564523260829, 0.1205704759775041,  0.12028187049207963,
                0.11877382394426432, 0.11235418971069551, 0.11427259307375376,
                0.1141988719878642,  0.11417065629089897, 0.11925613324695258,
                0.11929017347346252, 0.11928587397474723, 0.11925434830229423,
                0.11956565381909431, 0.11956054252282909, 0.11857207026426096,
                0.1185719168146091,  0.11910176669295232, 0.1186474182238687,
                0.11720667475976063, 0.11720684128931651
            ],
            # ----- SEED 4 -----
            [
                0.11744126807833664, 0.11444946292100519, 0.11557414818831067,
                0.12228766990045456, 0.11684093582867529, 0.11801150021546138,
                0.11795791647264435, 0.12366627406921178, 0.12365820295868533,
                0.123032840252533,   0.12196219513189949, 0.12249561838018623,
                0.11671937713065648, 0.11685379978312174, 0.11796598599730743,
                0.11796750506209137, 0.11688135096367747, 0.11673296829737403,
                0.11733534830752566, 0.11720686788859744
            ],
            # ----- SEED 5 -----
            [
                0.11522170935358979, 0.11792376243897541, 0.11365481228040564,
                0.1161242860111094,  0.11348604139342845, 0.11336466810982965,
                0.11353587324275558, 0.11513811158415635, 0.11513774585809701,
                0.11513737733082842, 0.11513780561603795, 0.1151070919663636,
                0.1151952238482307,  0.12473336293182785, 0.12349988214953365,
                0.12349982529478015, 0.12370170827444432, 0.12384319204205389,
                0.12340429347366237, 0.11720738733150102
            ],
            # ----- SEED 6 -----
            [
                0.117644729768175,   0.11261638588970914, 0.1117514203187081,
                0.11202621990310432, 0.11265474021772061, 0.11281054982128261,
                0.11248979385382453, 0.11237209247370274, 0.11658872860675293,
                0.11664832646962532, 0.11451569359436936, 0.11458504540299728,
                0.11463232048015604, 0.11463146739826746, 0.11355131324364057,
                0.12477234924931231, 0.12356810423754241, 0.12356812612404951,
                0.11720666349903687, 0.11720698441203464
            ],
            # ----- SEED 7 -----
            [
                0.11420836346630954, 0.11239637067388566, 0.11260844154559693,
                0.11460808077240259, 0.114112144632271,   0.11456727107018477,
                0.11455293534004055, 0.1127984022642017,  0.11248197437615373,
                0.11553355601987708, 0.11543456830703405, 0.11466045627315034,
                0.11466072198659365, 0.11466038795174298, 0.11544546778757139,
                0.11616142278714613, 0.11688114056741358, 0.11702328398428641,
                0.11697373807960001, 0.11720696831407552
            ],
            # ----- SEED 8 -----
            [
                0.11302498457399232, 0.11224860053922839, 0.11021050406549071,
                0.11412470340549036, 0.1134042243545884,  0.11411051230988115,
                0.1225616648924819,  0.12168412064473923, 0.12184321498363597,
                0.12184335276591231, 0.12153510728816641, 0.12139763411999356,
                0.12103538143135341, 0.1215397679206053,  0.1215397703113693,
                0.1215232869896186,  0.11640074538733264, 0.11648425411196664,
                0.11669228902358497, 0.11720691823814287
            ],
            # ----- SEED 9 -----
            [
                0.12087615972625808, 0.12250033185826471, 0.12356384897588162,
                0.11377477119339449, 0.11436098785202323, 0.11319542378428352,
                0.11162681168788077, 0.11222720572923249, 0.11408123971155287,
                0.11406460481348528, 0.11406479990304999, 0.11443581877215428,
                0.11822955845876398, 0.11822942579990423, 0.11809479719906096,
                0.1157930180833371,  0.11613485973006363, 0.1172792378431535,
                0.1172457600088686,  0.11720672879242215
            ],
        ],

        "PZ2": [
            # ----- SEED 0 -----
            [
                0.425391068502503,   0.41889448542142554, 0.41774674090077407,
                0.4174590835855749,  0.42278052217214507, 0.41936511254737,
                0.417880352469389,   0.41874162961373407, 0.41700982081003224,
                0.4191804961253322,  0.41758562161773705, 0.4188010317876578,
                0.41806313296849423, 0.41855176615889794, 0.4216250865934617,
                0.42123867932258374, 0.4215912426157646,  0.4215890979983781,
                0.4240395570338973,  0.4196159174284243
            ],
            # ----- SEED 1 -----
            [
                0.42336302492530126, 0.4240451351899482,  0.4231011281169537,
                0.4240268306427557,  0.4176817765732462,  0.4187964509440793,
                0.4185027747081323,  0.4166071515382115,  0.41548183824940194,
                0.4143870163535415,  0.4135018115050351,  0.4170712726568399,
                0.4229501518419802,  0.423693427232743,   0.4243879769372786,
                0.42462981613485673, 0.4258997325693468,  0.42588819496273567,
                0.41920164389233644, 0.41961609924063065
            ],
            # ----- SEED 2 -----
            [
                0.42627614427394384, 0.4180276629796095,  0.4158887844237976,
                0.4177740448106033,  0.43087687092436033, 0.42785134205555014,
                0.4265421190808538,  0.4257284579163981,  0.42512366154630993,
                0.4250742158117341,  0.424544861771983,   0.4242834861533788,
                0.4240547175926754,  0.4239706374622734,  0.4239459272272596,
                0.4245301110900251,  0.4247640027214225,  0.4253760077674075,
                0.41969918662252775, 0.41961686360820255
            ],
            # ----- SEED 3 -----
            [
                0.41987794532716644, 0.4220980475904255,  0.42336010408647246,
                0.4200276026329096,  0.4164568909545331,  0.41911383136660013,
                0.4199407470891904,  0.42405488283970066, 0.42586677627113323,
                0.4249019736027615,  0.42664629427642786, 0.4272931950011045,
                0.42805783492421084, 0.4280549041073869,  0.42801291044624523,
                0.4256484837126586,  0.4256448120057613,  0.4200966565496405,
                0.4192463205151844,  0.4196172545601474
            ],
            # ----- SEED 4 -----
            [
                0.43247266751721386, 0.42877001827649647, 0.428666083374312,
                0.4232772936367057,  0.4194373868266044,  0.42310656354187287,
                0.42186615932465954, 0.42237206087742524, 0.4221451730175054,
                0.4247855171444736,  0.42535622579668253, 0.42587603004287405,
                0.43027730112171425, 0.4308487875967951,  0.4311418596100855,
                0.42934911956139954, 0.42785514204522096, 0.42664219077267257,
                0.41958289121696196, 0.41961634139875587
            ],
            # ----- SEED 5 -----
            [
                0.4249753467921737,  0.43145546695891707, 0.43370421251961033,
                0.43185676737632644, 0.4323196635390951,  0.43077077859278307,
                0.4319330571088016,  0.4306300042791581,  0.4291529445526539,
                0.42917008520892963, 0.4280160456499271,  0.42508282067424513,
                0.42490419175479927, 0.42497044130750194, 0.41942352094112323,
                0.41943313030933965, 0.4194543446110798,  0.4191284781591516,
                0.41994686391651215, 0.41961652239731473
            ],
            # ----- SEED 6 -----
            [
                0.4281159299516499,  0.4246791481812261,  0.41838643655809177,
                0.4182227009101172,  0.41861609597032384, 0.41876256793479616,
                0.4185054630189769,  0.41735483029045173, 0.42096744666477864,
                0.42022188048563774, 0.42094625723722073, 0.41910499608477836,
                0.4178192362972525,  0.4178459523983608,  0.4179120927824076,
                0.41787724144656757, 0.4184204732097946,  0.4186683518714854,
                0.4189721035974067,  0.41961781139190957
            ],
            # ----- SEED 7 -----
            [
                0.42353377513102763, 0.4217481064963534,  0.4189929552344964,
                0.4163835931343291,  0.4147134487227539,  0.41434218893187985,
                0.41814480314031394, 0.42001237715990675, 0.4194457628363542,
                0.419114844648363,   0.4180925662873033,  0.418094265483733,
                0.4177971803296438,  0.4189263017618461,  0.4182644305656246,
                0.4190251763909692,  0.4199575743410753,  0.41990270907745236,
                0.4201728171128325,  0.41961685756007544
            ],
            # ----- SEED 8 -----
            [
                0.4319703322165097,  0.42594974223969934, 0.4204864098123805,
                0.4212579279729126,  0.4309699880045811,  0.4295574313661619,
                0.4264521539130168,  0.42487759053087,    0.42448911646147025,
                0.4254812705312056,  0.4236337778405833,  0.4244861363022505,
                0.42369772182464766, 0.4239082362344792,  0.41823602043711516,
                0.42089864314341424, 0.4187367155876781,  0.4190570419285586,
                0.4196173551446099,  0.4196165308158524
            ],
            # ----- SEED 9 -----
            [
                0.42394044426455507, 0.42873073309339993, 0.43488428192894796,
                0.4271990564722385,  0.4272056873062256,  0.4277010601410555,
                0.4275002916535836,  0.42682558753354016, 0.4265979942381392,
                0.4253527142754199,  0.41939375397940915, 0.41939355269406864,
                0.41900583121736074, 0.4196695550992567,  0.4198700781648637,
                0.41987252801329794, 0.41987142491719165, 0.4196742025454303,
                0.4196168615105017,  0.4196169159784431
            ],
        ],

        "PZ3": [
            # ----- SEED 0 -----
            [
                0.3462070484772058,  0.34750291537696876, 0.3486170653876265,
                0.3460922846027137,  0.35235229704195453, 0.3449398262412489,
                0.3443667901883821,  0.34643670855443165, 0.35166779959315475,
                0.3489885749997678,  0.34843652353569626, 0.3423183186422362,
                0.3390298017458589,  0.3383755539099694,  0.33970328175425524,
                0.33887848186464653, 0.3393647384747982,  0.34358282057114153,
                0.3424948752548963,  0.34289089491441943
            ],
            # ----- SEED 1 -----
            [
                0.3534721098626377,  0.35859319751893437, 0.3564773010311273,
                0.35981728516476963, 0.34349634624086794, 0.34476407030268175,
                0.3421023547751354,  0.33981406102012107, 0.33852972941250653,
                0.3373866912059636,  0.337634066517354,   0.33763565692433134,
                0.3374188587205467,  0.3376496088156542,  0.3364781993376486,
                0.34001550769306077, 0.3400160167969854,  0.339974051297365,
                0.3404588085208433,  0.3428918861882124
            ],
            # ----- SEED 2 -----
            [
                0.34580023093822887, 0.34307356202487654, 0.3398250276889202,
                0.3483321952429223,  0.35159089071476446, 0.350566808849737,
                0.3505657153442429,  0.353383073151924,   0.3445599094940667,
                0.3431024278872812,  0.3429067639586897,  0.3437193771151077,
                0.3421130816687978,  0.34235362333994057, 0.3379460580778711,
                0.3368685274310958,  0.34074801726551884, 0.3424298994268623,
                0.3409823672825604,  0.34289016519245386
            ],
            # ----- SEED 3 -----
            [
                0.3627172256279276,  0.36268475332601535, 0.35885396351936977,
                0.347174151403072,   0.34578605046520033, 0.3426330426154677,
                0.3445429713170301,  0.3417174148088048,  0.34006809325365966,
                0.337506384812145,   0.3385314516254233,  0.3393755843077295,
                0.3364632645195109,  0.33675093505891346, 0.33718946482229645,
                0.33718766603168154, 0.3389522419842672,  0.33918728499242173,
                0.33922222806136954, 0.3428911571880194
            ],
            # ----- SEED 4 -----
            [
                0.34540599439357134, 0.3520637393352616,  0.3426922652831869,
                0.3396996698965282,  0.3447026368493696,  0.34287875791024497,
                0.3473117227709294,  0.3426897495988624,  0.3373926207475035,
                0.3374248358653247,  0.3402992054702671,  0.3399571464048626,
                0.3416925469667865,  0.34066633340252694, 0.34066374110630376,
                0.3405638734130049,  0.34204435995616284, 0.340864712893568,
                0.3434584835242349,  0.3428910927804703
            ],
            # ----- SEED 5 -----
            [
                0.3425751292130388,  0.3417850050911786,  0.34357169595018555,
                0.33923338119705665, 0.33847906569807357, 0.34092734566449273,
                0.33984557170068136, 0.3396309903852892,  0.3384762587837803,
                0.3391228742020574,  0.33839353380404935, 0.33932437282143046,
                0.34199255769385534, 0.3384202210719176,  0.33737483896578685,
                0.33723413074648767, 0.3403744177055881,  0.33945834389545954,
                0.343041359919374,   0.3428916660188954
            ],
            # ----- SEED 6 -----
            [
                0.3464669713000038,  0.35057517297393137, 0.3526897172341288,
                0.3498868868684227,  0.34460254550886366, 0.3429286131257451,
                0.3431450224831442,  0.3452328556435836,  0.34472870324707844,
                0.3464046812832618,  0.3477952811727486,  0.34728299165262716,
                0.3401784286872088,  0.3422817457445086,  0.34001058321618793,
                0.340011424830093,   0.3442299980364055,  0.34387733002918236,
                0.34166775040091546, 0.3428903284464508
            ],
            # ----- SEED 7 -----
            [
                0.35817293963357155, 0.3496555740802799,  0.3497039595484795,
                0.3461981236602735,  0.3462159726445022,  0.34215177892370535,
                0.3433976355917391,  0.3418006560013527,  0.34174869131630053,
                0.3402817641564108,  0.3423005819593111,  0.339050195905442,
                0.3376770163306651,  0.33758529200108617, 0.3366889277973386,
                0.3366880721135144,  0.3377215766763383,  0.33771983766055885,
                0.3387539125772545,  0.3428908755430791
            ],
            # ----- SEED 8 -----
            [
                0.3425548951891968,  0.34159818139001435, 0.3400951994031453,
                0.3378172179099068,  0.34059792239569203, 0.33947541300157347,
                0.3398930436346273,  0.33785830686185675, 0.3414151637745841,
                0.3422423306329863,  0.3412815729158355,  0.3407659872648907,
                0.34145373412897795, 0.34264752958229244, 0.34274505233049646,
                0.3426466660138088,  0.3422371237832339,  0.3429543329216054,
                0.34197457097335104, 0.34289087898017306
            ],
            # ----- SEED 9 -----
            [
                0.3499001385458165,  0.34058291639880445, 0.33903094619282875,
                0.3418926462428022,  0.3406201492587829,  0.33930053878099714,
                0.3436230989381372,  0.34152193600734987, 0.34271232349659414,
                0.3422431105163767,  0.3421481691217267,  0.3431473726513402,
                0.34454681448460966, 0.340897560865472,   0.338973385623411,
                0.3425092453594754,  0.34244084350537274, 0.34207873834703256,
                0.34215941032946673, 0.34289175572146485
            ],
        ],

        "PZ4": [
            # ----- SEED 0 -----
            [
                0.49745801380589383, 0.5337033189385667,  0.5395812638550903,
                0.5674841390780846,  0.5844990417844786,  0.5715014513903235,
                0.6008104365232779,  0.6156719209232655,  0.607042826798976,
                0.5970474553120712,  0.5866385607615641,  0.588653304005586,
                0.5881566346597803,  0.5823927509237918,  0.5802246116908903,
                0.5766058006879323,  0.5732352467199744,  0.5622944426008127,
                0.5711790219429053,  0.5716330911318677
            ],
            # ----- SEED 1 -----
            [
                0.5436014419965827, 0.5448738336404226, 0.5739083157180654,
                0.5678378517441066, 0.5615692040685,    0.5589145814993695,
                0.5666469027981721, 0.5780770636701218, 0.5716775421166757,
                0.5655227872648237, 0.5615892484258361, 0.5776266572126957,
                0.5774737995188007, 0.5738457029054639, 0.5737282913373495,
                0.5813285294921765, 0.581932334823571,  0.5772525103024292,
                0.5774217883973363, 0.5716355037664582
            ],
            # ----- SEED 2 -----
            [
                0.5593534463783367, 0.5728589025818037, 0.545998693229619,
                0.5739330235232163, 0.5715873809297651, 0.5752047874627821,
                0.5681168776192969, 0.5712147536204238, 0.5673206272052372,
                0.5912707113680274, 0.5850832317147353, 0.5754462765477093,
                0.5736260802624461, 0.5737449362338062, 0.5612260087271932,
                0.5657060816210456, 0.5651546290206749, 0.5618480892883739,
                0.5635721712764238, 0.5716369653581106
            ],
            # ----- SEED 3 -----
            [
                0.489728354410021,   0.5436833571963754,  0.5590961953233092,
                0.5546539568710757,  0.5651210604469923,  0.5546541372507133,
                0.5546450311705087,  0.5362343786401148,  0.5344889555681106,
                0.5475476802665835,  0.5537902695637351,  0.5511310911405403,
                0.5473050923826339,  0.5471023196908785,  0.5496964173760882,
                0.570203144271967,   0.5689802521258434,  0.5710843066106318,
                0.5640087518428818,  0.5716446457678738
            ],
            # ----- SEED 4 -----
            [
                0.5339193329309174,  0.5673344207985338,  0.5788176522631103,
                0.5805581768498461,  0.5945375162646336,  0.5879465128731485,
                0.5785119809333559,  0.5840828408356006,  0.5846997474604898,
                0.5853261570828083,  0.6034211037564808,  0.598532366190153,
                0.5972089953198915,  0.5729277838373339,  0.5743055351490102,
                0.572164954761332,   0.5724298361622147,  0.57424068260343,
                0.5757035571229964,  0.5716751947580067
            ],
            # ----- SEED 5 -----
            [
                0.4979474363385062,  0.5245540544488004,  0.5648043046620376,
                0.584108634695069,   0.5792444392197649,  0.57966084800302,
                0.5750799932489608,  0.5683806277334467,  0.5662083668628931,
                0.5656324738814276,  0.5672333617033937,  0.5548978920221075,
                0.569225378854117,   0.5670921923417556,  0.567889913159234,
                0.5689274612543435,  0.5753297766384124,  0.5727925856647867,
                0.5769075774415925,  0.5716619310083917
            ],
            # ----- SEED 6 -----
            [
                0.5497408342030276,  0.5272865460497457,  0.5270673185760161,
                0.5439488924277376,  0.5054357762368223,  0.5048646267250543,
                0.5425425341951966,  0.5450561104575612,  0.5673845740526926,
                0.5644246125465309,  0.5628895150526216,  0.5779249103326793,
                0.5698409932144389,  0.5698220503449714,  0.5893816294569668,
                0.5823423412264448,  0.5772873307598333,  0.5734116540497931,
                0.5682045645373462,  0.5716526985127619
            ],
            # ----- SEED 7 -----
            [
                0.5679805927240434,  0.5689997392504779,  0.5644218434074618,
                0.5579752651838567,  0.5504875439496554,  0.5599245886467463,
                0.563800468267151,   0.5607282425926143,  0.577692585336399,
                0.5690936224419995,  0.5591004586391168,  0.5639345847641409,
                0.5751194744420854,  0.5711007904392107,  0.5719805308373502,
                0.572737861326329,   0.5705726148160091,  0.5597976763833725,
                0.5625658191735041,  0.5716506877650696
            ],
            # ----- SEED 8 -----
            [
                0.5362331559959468,  0.5528132211444207,  0.5692060708935114,
                0.5769234153536048,  0.5769932758782825,  0.5769191706096783,
                0.5775780389764639,  0.5673317848819316,  0.5771424075422634,
                0.5900713372355546,  0.5768232675225115,  0.5668226920509831,
                0.5686007906360003,  0.5808814956065591,  0.5825019762177435,
                0.5952536877788173,  0.5774094689909878,  0.5753770458229774,
                0.5750848869940087,  0.5716753845386116
            ],
            # ----- SEED 9 -----
            [
                0.5155860647699037,  0.540516706185388,   0.5685808298473836,
                0.5620007700221068,  0.5760275000558244,  0.5863593770848017,
                0.5680012913268139,  0.5640937805267343,  0.5637982316257449,
                0.578365814827914,   0.5854575358920822,  0.5865272239288906,
                0.5873058462198079,  0.5895877036144385,  0.5901949681359305,
                0.5785333038170186,  0.5742818357922828,  0.5750874469962687,
                0.5714707878591849,  0.5715478347041077
            ],
        ],

        "PZ5": [
            # ----- SEED 0 -----
            [
                0.43701092845919,    0.43947871371250063, 0.4345595159948547,
                0.4283886617148281,  0.4261605974071543,  0.42130577412246095,
                0.4270694787081995,  0.42456758324159805, 0.4261548948562148,
                0.41905606435880677, 0.4162238810542892,  0.42807419690974796,
                0.42417037536502694, 0.4247596633356275,  0.4252285183577841,
                0.4091195915748805,  0.4260223820903671,  0.4280293175523842,
                0.4009469702714947,  0.3967902733869354
            ],
            # ----- SEED 1 -----
            [
                0.448799063499743,   0.45057405017560875, 0.41316177399433535,
                0.4020547721932945,  0.4005297801594718,  0.41405052867330167,
                0.4127488458898096,  0.41136022409930556, 0.40547169325926086,
                0.40365687444042014, 0.41091407196666463, 0.3972031450287414,
                0.4092035207774229,  0.43307562840247993, 0.39415538367747194,
                0.40936344248482415, 0.395647996571567,   0.3964421832096146,
                0.39729898856139456, 0.3967893826663288
            ],
            # ----- SEED 2 -----
            [
                0.4302945068472955,  0.41286049940675645, 0.4241759174983325,
                0.4105220700989621,  0.4108469272232433,  0.4081968483498285,
                0.39371577658582213, 0.3980950232709335,  0.405196228132365,
                0.4133064107543568,  0.4160879315327372,  0.4145338340771093,
                0.3953196489185913,  0.3996189827650803,  0.3991164660086214,
                0.39994740881603047, 0.39409747878910656, 0.4019960704593228,
                0.4024681335923063,  0.39679064383836543
            ],
            # ----- SEED 3 -----
            [
                0.4129961693404957,  0.4315183047416816,  0.40979905276645223,
                0.3974892257422758,  0.39473378242184176, 0.3953209643370109,
                0.39468021422540844, 0.39678578470662307, 0.39295144795240466,
                0.40276491436689743, 0.4148979843701473,  0.41641129434390034,
                0.4197789899707557,  0.42853416468261524, 0.430809463219238,
                0.4250802380346084,  0.4250752079986466,  0.3983676339774097,
                0.39633168979520206, 0.3967936086227984
            ],
            # ----- SEED 4 -----
            [
                0.45670010533577776, 0.44123740097631886, 0.3977414573703693,
                0.3874210591532695,  0.41764300425815476, 0.4020341983896575,
                0.4041682835342977,  0.41311350941096475, 0.42011414348177045,
                0.41982158926545987, 0.42158065421796387, 0.41512957143528895,
                0.41525937455295836, 0.41391658967496275, 0.41353660407948273,
                0.41190579985359793, 0.42855907920998315, 0.4307102293859702,
                0.3949727381529677,  0.39679450725671117
            ],
            # ----- SEED 5 -----
            [
                0.4384610904993116,  0.43850987612930825, 0.4209519134406277,
                0.41953595513257197, 0.4161420968116819,  0.41301566272195905,
                0.42870477662166234, 0.43094974033056727, 0.4306574497231464,
                0.4307223917614664,  0.43458434935297097, 0.4026958415790942,
                0.42495814613235416, 0.39917104417550836, 0.39789553720080884,
                0.39579318243609557, 0.39391700867874535, 0.3972689692461459,
                0.39720298100310814, 0.396788758084493
            ],
            # ----- SEED 6 -----
            [
                0.44770841366065006, 0.42807044362574803, 0.42490893468434204,
                0.42475807040452046, 0.4287149579508949,  0.43445453051540445,
                0.44030322796707566, 0.4402293888448062,  0.4398527162785464,
                0.43689217525695107, 0.4368417589443648,  0.4067598514138972,
                0.4070862273425858,  0.40857686274575045, 0.40367645123167983,
                0.40371143191826475, 0.4059972412355099,  0.40617947901630397,
                0.40009613494499513, 0.39679034528373136
            ],
            # ----- SEED 7 -----
            [
                0.44432651444128096, 0.4305640344933038,  0.44439725404362573,
                0.4449476989842438,  0.4443533494785928,  0.4329857124838916,
                0.4203486241785414,  0.41422358443097335, 0.40863663134997374,
                0.4201932178566138,  0.42032465136532143, 0.4187718791723919,
                0.42870307856635537, 0.4228940648146847,  0.41552554031281375,
                0.41398122814778066, 0.4111638216298397,  0.4153119116070295,
                0.39637695552851415, 0.3967957283636419
            ],
            # ----- SEED 8 -----
            [
                0.4567062323290182,  0.41864085457736083, 0.41850822314831015,
                0.4135108005614907,  0.39962018334642085, 0.4124528952193077,
                0.4127045317403667,  0.41757473403143863, 0.41424786114151024,
                0.4193154574665744,  0.43840800885177333, 0.43510475580025976,
                0.43475044477877245, 0.40822363192237876, 0.408965335594306,
                0.4060371348726962,  0.4036356350751314,  0.3967557628739327,
                0.39727701391782017, 0.39678799078921245
            ],
            # ----- SEED 9 -----
            [
                0.4268313196501578,  0.4358240971123352,  0.42477776340034845,
                0.4217026328158809,  0.42838272381902665, 0.4252669553156474,
                0.42551101180506146, 0.4251619043682213,  0.4292306788688768,
                0.42854895942362653, 0.42880653435481725, 0.42660660502104997,
                0.4258287763764627,  0.42797885991634693, 0.40398227867252495,
                0.4228079396271912,  0.3944893095204755,  0.3970747196268762,
                0.3970807424866913,  0.3967913943629527
            ],
        ],
    }
}

# ===========================
# PR (Pixel AUPRC) PER SEED
# SPADE – PZ1..PZ5
# (qui ci sono i seed 6–9 che mi hai passato)
# ===========================

results_pr_by_method = {
    "SPADE": {

        "PZ1": [
            # ----- SEED 6 -----
            [
                0.3807804846424678,  0.3821274209176414,  0.38743149668190013,
                0.38727335500027016, 0.38631615437857453, 0.38581102370115666,
                0.3858252559667349,  0.38607357980314083, 0.3852468479405418,
                0.3843114952371684,  0.38054689132445685, 0.3805053198120105,
                0.3806200458088641,  0.3805896214790283,  0.38050270287189303,
                0.3843977852397487,  0.3843683996812399,  0.38525011779383933,
                0.382784999934165,   0.38273776763226824
            ],
            # ----- SEED 7 -----
            [
                0.38910716887067853, 0.3865791116548118,  0.3898002834819714,
                0.3862911487705533,  0.3854366146695819,  0.3833016583692457,
                0.3832716070982156,  0.3830445322192846,  0.38302874479546334,
                0.3808044929465215,  0.3806004713098915,  0.3801020577264113,
                0.38010212402583454, 0.3817863756813653,  0.3819451921804383,
                0.38282737171800396, 0.3837014540566025,  0.3834767866982146,
                0.38331618538838197, 0.3827364328915114
            ],
            # ----- SEED 8 -----
            [
                0.38913075515395257, 0.3867430397591537,  0.38628863847743045,
                0.3851252018753909,  0.3850443431131015,  0.38555775158048483,
                0.3874417822832616,  0.38748505144062495, 0.3876327297877522,
                0.3875715310680894,  0.3875105045789348,  0.38745931434609215,
                0.3844090834400238,  0.3825583553007236,  0.38255812289812324,
                0.3825084003696258,  0.3803540026097487,  0.3800628792218701,
                0.38137875373613056, 0.3827374945629225
            ],
            # ----- SEED 9 -----
            [
                0.38491643504728545, 0.3862791114634498,  0.38982693029495336,
                0.38801945957665196, 0.3874025443953062,  0.3866920900638161,
                0.38130193302801535, 0.38052731302755094, 0.381002187000514,
                0.38143940172347757, 0.3807552588250271,  0.3818695527632415,
                0.3813510696689718,  0.38135324919557173, 0.381350054384446,
                0.3812927574302886,  0.3820953379711314,  0.38303859688609315,
                0.3828340556794395,  0.3827378100164636
            ],
        ],

        "PZ2": [
            # ----- SEED 6 -----
            [
                0.38254817408918934, 0.3772781807632708,  0.37442892846081244,
                0.3747460829135053,  0.3737880750414875,  0.3763538387383296,
                0.37597620199172876, 0.3764627159285729,  0.37604025120045614,
                0.37627598467822765, 0.3797121261607384,  0.3795033026695307,
                0.37866259896236376, 0.37834188325014156, 0.3793580015376006,
                0.3793305695493713,  0.3795970887499768,  0.3791631552029191,
                0.3787842017768281,  0.3793269449041343
            ],
            # ----- SEED 7 -----
            [
                0.37900302335365904, 0.37876786719765665, 0.3764482464763361,
                0.3754807768483005,  0.3761518308979885,  0.37745569209327806,
                0.3787374887985596,  0.3796723957276275,  0.3795977017024145,
                0.3792018453456738,  0.3786461627733474,  0.3786470918990035,
                0.3785773327974341,  0.3798428071411491,  0.37896210141637204,
                0.3788085143880586,  0.37970341583008355, 0.37963315055420865,
                0.37941749984464324, 0.37932678149843096
            ],
            # ----- SEED 8 -----
            [
                0.38668726427903577, 0.3799103700132837,  0.3753052467973124,
                0.37740418298014833, 0.38406846582385457, 0.38337936772188674,
                0.38166309090116535, 0.3812234162640777,  0.38093911505498446,
                0.38044697618295265, 0.38074774292811314, 0.3810085120721699,
                0.38080778181551833, 0.3811458278228369,  0.37757770147553615,
                0.37951612910917787, 0.37855734398203184, 0.3790081300529118,
                0.3793277541162397,  0.37932551888577926
            ],
            # ----- SEED 9 -----
            [
                0.3899552072502843,  0.37976545208757606, 0.3864195724265005,
                0.3810848918679317,  0.3807880894670624,  0.3820179251447692,
                0.38157421989249923, 0.3824595226618426,  0.38305257866339926,
                0.3831848654003459,  0.37878002598571403, 0.3787789602435635,
                0.3780200467033242,  0.3780529492177968,  0.3794981603254022,
                0.3794576185918803,  0.379475199560041,   0.3793952074504202,
                0.379323700358276,   0.3793266046740117
            ],
        ],

        "PZ3": [
            # ----- SEED 6 -----
            [
                0.3838254584908718,  0.3919727223994874,  0.3967879292322979,
                0.4123931024970443,  0.3932198285011228,  0.3903843827090577,
                0.3865537574543015,  0.3857200105621347,  0.3839313492515559,
                0.3851604909123713,  0.38678850013675653, 0.38640997982593284,
                0.3852334930960265,  0.38663882016765333, 0.3906119286141663,
                0.39061154925574093, 0.388773640874324,   0.3880734656416388,
                0.38367266342709716, 0.3869441496136259
            ],
            # ----- SEED 7 -----
            [
                0.39539479156895335, 0.3878294395685145,  0.40169335944466383,
                0.39917440610898225, 0.39921285398337253, 0.40020892811767234,
                0.40257017648577526, 0.39066545088396615, 0.38298804333615954,
                0.3812204387567206,  0.3811581580012526,  0.3857809466522559,
                0.3866833751149497,  0.38685818766926294, 0.38678090072947713,
                0.3867789469417481,  0.38865066235420165, 0.3886516874249151,
                0.3887634662721996,  0.3869427291356714
            ],
            # ----- SEED 8 -----
            [
                0.3835581936121047,  0.3813681760551992,  0.3973876827422858,
                0.39055921684218675, 0.3885399188594001,  0.38855616409281696,
                0.3900176108693414,  0.387674993107694,   0.3901436639267794,
                0.390621729688388,   0.3868266042550116,  0.38667304931419,
                0.3864911845585518,  0.3884183920961971,  0.3883104646337356,
                0.3884174707372055,  0.38820373710419026, 0.38642627236015026,
                0.38617977216025445, 0.38694253978725834
            ],
            # ----- SEED 9 -----
            [
                0.38789717332100127, 0.40013861432954057, 0.4058911984695212,
                0.4024611582284092,  0.39206399351154897, 0.39086776432049214,
                0.39733326969738786, 0.3889449497369579,  0.3905760394910413,
                0.39051454635690575, 0.3902606782952869,  0.3869311064698039,
                0.3870725265850262,  0.39198700167003114, 0.3904419625220005,
                0.3896734567888439,  0.389578134807407,   0.38937964021220267,
                0.3894231475343006,  0.38694346325392304
            ],
        ],

        "PZ4": [
            # ----- SEED 6 -----
            [
                0.3316235885762677,  0.3192243794491122,  0.32052007316979175,
                0.32443296585732356, 0.3095343682699727,  0.31129538258130485,
                0.3229606238281304,  0.32291238139948497, 0.3256820532303656,
                0.3247809664474284,  0.3241630857788996,  0.32371875688048585,
                0.3229462743694025,  0.3241083381725289,  0.32630619129602667,
                0.32610590095942826, 0.32640793580642846, 0.32366586001336206,
                0.32238503955689735, 0.3228561024416337
            ],
            # ----- SEED 7 -----
            [
                0.3251388277211924,  0.3233308023267757,  0.32456578572406347,
                0.32471511547114207, 0.3236635702657128,  0.321165822671705,
                0.3255717577799156,  0.3221573623821585,  0.3262582703647614,
                0.321055186108732,   0.31848336768546426, 0.3169990139084324,
                0.31824550430592663, 0.31768567875104714, 0.31757688762035574,
                0.3175037645565878,  0.3173424259056656,  0.31713106414192166,
                0.32063002836380056, 0.3228862280920901
            ],
            # ----- SEED 8 -----
            [
                0.3309403629093199,  0.32895506846984024, 0.336868041764844,
                0.3403499744388518,  0.32825876866709025, 0.3259523724982208,
                0.3294645723525984,  0.32451342236805797, 0.3283781317923409,
                0.32702134534453003, 0.3196104203582848,  0.3155403539785904,
                0.3173994175282559,  0.3203561781078025,  0.3209041814259946,
                0.3267234081781015,  0.323413437658853,   0.3236639387656868,
                0.32365126423802404, 0.3228687635729066
            ],
            # ----- SEED 9 -----
            [
                0.3179984457342267,  0.32400458365989954, 0.32548360803996834,
                0.32154507183427916, 0.32829720957615655, 0.32312867410626933,
                0.317628633204012,   0.3157212504364064,  0.31797957183833087,
                0.3182732175680703,  0.31945323240275175, 0.3203740598186371,
                0.3197360295110591,  0.32334309794505595, 0.3230349054427597,
                0.32233448427481126, 0.321265080269739,   0.321844088520885,
                0.3212844570350003,  0.3228543083557408
            ],
        ],

        "PZ5": [
            # ----- SEED 6 -----
            [
                0.1955900852136823,  0.18752208101755635, 0.18881584729806053,
                0.18859309306319824, 0.18965260511364276, 0.19211855937226596,
                0.19184961944113443, 0.1873004140227679,  0.18719676466951102,
                0.1846137720960956,  0.18411191027992507, 0.17327024684898382,
                0.1733965659735645,  0.1769811511000053,  0.1734120566952762,
                0.1735385731583502,  0.17225020784391815, 0.17217925070120538,
                0.16910733536609074, 0.16654703537317592
            ],
            # ----- SEED 7 -----
            [
                0.19888551866718684, 0.18767164728440244, 0.19442912826388575,
                0.19498084133274488, 0.19530579594981945, 0.19275205423908323,
                0.1864720644058625,  0.1834404043152251,  0.18099130635502375,
                0.18262870093415098, 0.18301882798932884, 0.18135794087677704,
                0.1838341102072633,  0.18095211696906618, 0.17518399337330323,
                0.17457895098486026, 0.17356167583840923, 0.1744254328937626,
                0.16709527190491202, 0.16654875236696431
            ],
            # ----- SEED 8 -----
            [
                0.19730980841571574, 0.18678211675441453, 0.1864014076054433,
                0.1825376322509056,  0.17583847275615622, 0.17973231258597977,
                0.18118353594670364, 0.18293430379358033, 0.18049336394005205,
                0.1831429763904152,  0.18507777206792667, 0.18276957058285626,
                0.18405554420041392, 0.17090333962837154, 0.17235352745918942,
                0.1719288760816045,  0.16980339266315367, 0.16681338722364678,
                0.1673990677408576,  0.1665446265943093
            ],
            # ----- SEED 9 -----
            [
                0.1845795099108643,  0.18692048509761985, 0.18404933073717972,
                0.1849384812135194,  0.1864982304727556,  0.18295624172145944,
                0.18450625919074248, 0.18430993804947216, 0.1828756978472649,
                0.18225602969472404, 0.18118397974635392, 0.17877489268861516,
                0.1786264769446263,  0.18005439255310807, 0.17136590957392608,
                0.17757146709023575, 0.16606182917766604, 0.16652355724364803,
                0.16674794676890647, 0.16654664206992847
            ],
        ],
    }
}

# Colori per i pezzi
colors_pieces = {
    "PZ1": "blue",
    "PZ2": "orange",
    "PZ3": "green",
    "PZ4": "red",
    "PZ5": "purple",
}

# =================================================
# FUNZIONE: PRO – PUNTI TUTTI I SEED + CURVA MEDIA
# E STAMPA VARIANZA / CV PER OGNI GOOD_FRACTION
# =================================================

def plot_method_pro(method_name, pieces_dict):
    print(f"\n=== {method_name} – Pixel-level AUC-PRO ===")

    plt.figure(figsize=(8, 5))

    for piece_name, values in pieces_dict.items():
        arr = np.array(values, dtype=float)
        color = colors_pieces.get(piece_name, None)

        if arr.ndim == 1:
            curves = arr.reshape(1, -1)
        elif arr.ndim == 2:
            curves = arr
        else:
            raise ValueError(
                f"{method_name} – {piece_name}: 'values' ha dim = {arr.ndim}, "
                "mi aspetto 1D oppure 2D (num_seeds x num_frazioni)."
            )

        num_seeds, num_frac = curves.shape
        if num_frac != len(good_fractions):
            raise ValueError(
                f"{method_name} – {piece_name}: colonne = {num_frac}, "
                f"ma len(good_fractions) = {len(good_fractions)}"
            )

        mean_y = curves.mean(axis=0)
        var_y  = curves.var(axis=0)
        std_y  = curves.std(axis=0)

        print(f"\n{method_name} – {piece_name}: {num_seeds} seed per ciascuna Good Fraction")
        for j, gf in enumerate(good_fractions):
            vals   = curves[:, j]
            mean_j = vals.mean()
            var_j  = vals.var()
            std_j  = vals.std()
            cv_pct = 100.0 * std_j / mean_j if mean_j != 0 else np.nan
            print(
                f"  GF = {gf:.2f} -> mean = {mean_j:.6f}, "
                f"var = {var_j:.6e}, std = {std_j:.6f}, CV = {cv_pct:.2f}%"
            )

        #  tutte le realizzazioni per ogni GF
        for j, gf in enumerate(good_fractions):
            plt.scatter(
                np.full(num_seeds, gf),
                curves[:, j],
                alpha=0.4,
                s=20,
                color=color
            )

        # CURVA MEDIA
        plt.plot(
            good_fractions,
            mean_y,
            marker="o",
            linewidth=2,
            label=f"{piece_name} (media)",
            color=color
        )

    plt.title(f"{method_name} – Pixel-level AUC-PRO vs Good Fraction")
    plt.xlabel("Good Fraction")
    plt.ylabel("Pixel AUC-PRO")
    plt.grid(True)
    plt.legend()
    plt.tight_layout()
    plt.show()


# =================================================
# FUNZIONE: PR – AUPRC
# =================================================

def plot_method_pr(method_name, pieces_dict):
    print(f"\n=== {method_name} – Pixel-level AUPRC (PR) ===")

    plt.figure(figsize=(8, 5))

    for piece_name, values in pieces_dict.items():
        arr = np.array(values, dtype=float)
        color = colors_pieces.get(piece_name, None)

        if arr.ndim == 1:
            curves = arr.reshape(1, -1)
        elif arr.ndim == 2:
            curves = arr
        else:
            raise ValueError(
                f"{method_name} – {piece_name}: 'values' ha dim = {arr.ndim}, "
                "mi aspetto 1D oppure 2D (num_seeds x num_frazioni)."
            )

        num_seeds, num_frac = curves.shape
        if num_frac != len(good_fractions):
            raise ValueError(
                f"{method_name} – {piece_name}: colonne = {num_frac}, "
                f"ma len(good_fractions) = {len(good_fractions)}"
            )

        mean_y = curves.mean(axis=0)
        var_y  = curves.var(axis=0)
        std_y  = curves.std(axis=0)

        print(f"\n{method_name} – {piece_name}: {num_seeds} seed per ciascuna Good Fraction (PR)")
        for j, gf in enumerate(good_fractions):
            vals   = curves[:, j]
            mean_j = vals.mean()
            var_j  = vals.var()
            std_j  = vals.std()
            cv_pct = 100.0 * std_j / mean_j if mean_j != 0 else np.nan
            print(
                f"  GF = {gf:.2f} -> mean = {mean_j:.6f}, "
                f"var = {var_j:.6e}, std = {std_j:.6f}, CV = {cv_pct:.2f}%"
            )

        #  tutte le realizzazioni per ogni GF
        for j, gf in enumerate(good_fractions):
            plt.scatter(
                np.full(num_seeds, gf),
                curves[:, j],
                alpha=0.4,
                s=20,
                color=color
            )

        # CURVA MEDIA
        plt.plot(
            good_fractions,
            mean_y,
            marker="o",
            linewidth=2,
            label=f"{piece_name} (media)",
            color=color
        )

    plt.title(f"{method_name} – Pixel-level AUPRC (PR) vs Good Fraction")
    plt.xlabel("Good Fraction")
    plt.ylabel("Pixel AUPRC (PR)")
    plt.grid(True)
    plt.legend()
    plt.tight_layout()
    plt.show()


# =================================================
# LANCIA PER SPADE
# =================================================

plot_method_pro("SPADE", results_pro_by_method["SPADE"])
plot_method_pr("SPADE",  results_pr_by_method["SPADE"])
